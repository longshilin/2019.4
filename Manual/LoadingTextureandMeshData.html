<!DOCTYPE html><html class="no-js" lang="zh-cn">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
      new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-5V25JL6');
    </script><link href="https://fonts.googleapis.com/css?family=Roboto&amp;display=swap" rel="stylesheet">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="twitter:card" content="summary">
<meta property="og:title" content="Loading texture and mesh data - Unity 手册">
<title>Loading texture and mesh data - Unity 手册</title>
<meta property="og:image" content="https://docs.unity3d.com/cn/2019.4/C:/Mercurial/Manual/2020.1/content/uploads/Main/AsyncUploadQualitySettings.png">
<meta name="description" content="Unity can load texture and mesh data from disk and upload it to the GPU in two different ways: synchronously or asynchronously. These two processes are called the synchronous upload pipeline and the asynchronous upload pipeline.">
<meta property="og:description" content="Unity can load texture and mesh data from disk and upload it to the GPU in two different ways: synchronously or asynchronously. These two processes are called the synchronous upload pipeline and the asynchronous upload pipeline.">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="https://unity.com/themes/contrib/unity_base/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png">
<script>
      var docs_type = 'Manual';
      var lang = 'cn';
      var page = 'LoadingTextureandMeshData';
      if(!page) page = 'index';
      var version = '2019.4';
      var docs_versions = [{version: '2020.2',version_string: '2020.2',supported: true},{version: '2020.1',version_string: '2020.1',supported: true},{version: '2019.4',version_string: '2019.4',supported: true},{version: '2019.3',version_string: '2019.3',supported: false},{version: '2019.2',version_string: '2019.2',supported: false},{version: '2019.1',version_string: '2019.1',supported: false},{version: '2018.4',version_string: '2018.4',supported: true},{version: '2018.3',version_string: '2018.3',supported: false},{version: '2018.2',version_string: '2018.2',supported: false},{version: '2018.1',version_string: '2018.1',supported: false},{version: '2017.4',version_string: '2017.4',supported: false},{version: '2017.3',version_string: '2017.3',supported: false},{version: '2017.2',version_string: '2017.2',supported: false},{version: '2017.1',version_string: '2017.1',supported: false},{version: '5.6',version_string: '560',supported: false},];</script><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="../StaticFiles/js/core.js"></script><script type="text/javascript" src="../StaticFiles/js/jquery.sidebar.min.js"></script><script type="text/javascript" src="docdata/toc.js"></script><script type="text/javascript" src=""></script><script type="text/javascript" src="../StaticFiles/js/custom.js"></script><link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css">
<link rel="stylesheet" type="text/css" href="../StaticFiles/css/custom.css">
<link rel="canonical" href="https://docs.unity3d.com/cn/2019.4/Manual/LoadingTextureandMeshData.html">
<link rel="alternate" href="https://docs.unity3d.com/en/2019.4/Manual/LoadingTextureandMeshData.html" hreflang="en">
<link rel="alternate" href="https://docs.unity3d.com/cn/2019.4/Manual/LoadingTextureandMeshData.html" hreflang="zh">
<link rel="alternate" href="https://docs.unity3d.com/ja/2019.4/Manual/LoadingTextureandMeshData.html" hreflang="ja">
<link rel="alternate" href="https://docs.unity3d.com/es/2019.4/Manual/LoadingTextureandMeshData.html" hreflang="es">
<link rel="alternate" href="https://docs.unity3d.com/kr/2019.4/Manual/LoadingTextureandMeshData.html" hreflang="ko">
<link rel="alternate" href="https://docs.unity3d.com/ru/2019.4/Manual/LoadingTextureandMeshData.html" hreflang="ru">
<link rel="alternate" href="https://docs.unity3d.com/2019.4/Documentation/Manual/LoadingTextureandMeshData.html" hreflang="x-default">
</head>
<body>
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-5V25JL6" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div id="nav-open" for="nav-input"><span></span></div>
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="搜索手册..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul class="menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">
                unity3d.com
              </a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.4</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/LoadingTextureandMeshData.html">2020.2</a></li>
<li class="supported"><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/LoadingTextureandMeshData.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/LoadingTextureandMeshData.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/LoadingTextureandMeshData.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/LoadingTextureandMeshData.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/LoadingTextureandMeshData.html">2019.1</a></li>
<li class="supported"><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/LoadingTextureandMeshData.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/LoadingTextureandMeshData.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/LoadingTextureandMeshData.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/LoadingTextureandMeshData.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/LoadingTextureandMeshData.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/LoadingTextureandMeshData.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/LoadingTextureandMeshData.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/LoadingTextureandMeshData.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/LoadingTextureandMeshData.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<ul class="nav-menu-items">
<li class="menu-item"><a href="../Manual/index.html" class="selected">手册</a></li>
<li class="menu-item"><a href="../ScriptReference/index.html" class="">脚本 API</a></li>
</ul>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">语言:
        <span class="b">中文</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a data-lang="en" href="/2019.4/Documentation/Manual/LoadingTextureandMeshData.html">English</a></li>
<li><a data-lang="cn" href="/cn/2019.4/Manual/LoadingTextureandMeshData.html">中文</a></li>
<li><a data-lang="ja" href="/ja/2019.4/Manual/LoadingTextureandMeshData.html">日本語</a></li>
<li><a data-lang="es" href="/es/2019.4/Manual/LoadingTextureandMeshData.html">Español</a></li>
<li><a data-lang="kr" href="/kr/2019.4/Manual/LoadingTextureandMeshData.html">한국어</a></li>
<li><a data-lang="ru" href="/ru/2019.4/Manual/LoadingTextureandMeshData.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar hidden"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc">
<h2>手册</h2>
<div class="version-switcher">
<div class="current toggle" data-target=".version-list"><div class="version-number">
<div class="d-inline-block">
          Version:
          <b>2019.4</b>
</div>
<div class="d-inline-block arrow"></div>
</div></div>
<div class="version-list" style="display:none;">
<ul class="versions">
<li class="supported"><a class="docs_version_url_2020.2" href="/cn/2020.2/Manual/LoadingTextureandMeshData.html">2020.2</a></li>
<li class="supported"><a class="docs_version_url_2020.1" href="/cn/2020.1/Manual/LoadingTextureandMeshData.html">2020.1</a></li>
<li class="supported"><a class="docs_version_url_2019.4" href="/cn/2019.4/Manual/LoadingTextureandMeshData.html">2019.4</a></li>
<li class=""><a class="docs_version_url_2019.3" href="/cn/2019.3/Manual/LoadingTextureandMeshData.html">2019.3</a></li>
<li class=""><a class="docs_version_url_2019.2" href="/cn/2019.2/Manual/LoadingTextureandMeshData.html">2019.2</a></li>
<li class=""><a class="docs_version_url_2019.1" href="/cn/2019.1/Manual/LoadingTextureandMeshData.html">2019.1</a></li>
<li class="supported"><a class="docs_version_url_2018.4" href="/cn/2018.4/Manual/LoadingTextureandMeshData.html">2018.4</a></li>
<li class=""><a class="docs_version_url_2018.3" href="/cn/2018.3/Manual/LoadingTextureandMeshData.html">2018.3</a></li>
<li class=""><a class="docs_version_url_2018.2" href="/cn/2018.2/Manual/LoadingTextureandMeshData.html">2018.2</a></li>
<li class=""><a class="docs_version_url_2018.1" href="/cn/2018.1/Manual/LoadingTextureandMeshData.html">2018.1</a></li>
<li class=""><a class="docs_version_url_2017.4" href="/cn/2017.4/Manual/LoadingTextureandMeshData.html">2017.4</a></li>
<li class=""><a class="docs_version_url_2017.3" href="/cn/2017.3/Manual/LoadingTextureandMeshData.html">2017.3</a></li>
<li class=""><a class="docs_version_url_2017.2" href="/cn/2017.2/Manual/LoadingTextureandMeshData.html">2017.2</a></li>
<li class=""><a class="docs_version_url_2017.1" href="/cn/2017.1/Manual/LoadingTextureandMeshData.html">2017.1</a></li>
<li class=""><a class="docs_version_url_560" href="/cn/560/Manual/LoadingTextureandMeshData.html">5.6</a></li>
<div class="versionsWithThisPage" style="display:none;"><li><p>包含此页的版本：</p></li></div>
<div class="versionsWithoutThisPage" style="display:none;"><li><p>不含此页的版本：</p></li></div>
</ul>
<ul class="description">
<li>
<div class="supported-box"></div>受支持</li>
<li>
<div class="legacy-box"></div>旧版</li>
</ul>
</div>
</div>
<div class="clear"></div>
</div></div></div></div></div>
<div id="content-wrap" class="content-wrap opened-sidebar"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity 用户手册 (2019.4 LTS)</a></li>
<li><a href="Graphics.html">图形</a></li>
<li>高级渲染功能</li>
<li>Loading texture and mesh data</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="CullingGroupAPI.html"></a></span><div class="tip">CullingGroup API</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="OptimizingGraphicsPerformance.html"></a></span><div class="tip">优化图形性能</div>
</div>
</div></div>
<h1>Loading texture and mesh data</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>Unity can load texture and mesh data from disk and upload it to the GPU in two different ways: synchronously or asynchronously. These two processes are called the synchronous upload pipeline and the asynchronous upload pipeline.</p>

<p>When Unity uses the synchronous upload pipeline, it cannot perform other tasks while it loads and uploads the data. This can cause visible pauses in your application. When Unity uses the asynchronous upload pipeline, it can perform other tasks while it loads and uploads the data in the background.</p>

<p>If a texture or mesh is eligible for the asynchronous upload pipeline, Unity uses the asynchronous upload pipeline automatically. If a texture or mesh is ineligible for the asynchronous upload pipeline, Unity uses the synchronous upload pipeline automatically.</p>

<h2>工作原理</h2>

<p>The main difference between the synchronous and asynchronous upload pipelines is where Unity saves the data at build time, which affects how Unity loads it at runtime.</p>

<p>In the synchronous upload pipeline, Unity must load both the metadata (header data) and the texel or vertex data (binary data) for the texture or mesh in a single frame. In the asynchronous upload pipeline, Unity must load only the header data in a single frame, and it can stream the binary data to the GPU over subsequent frames.</p>

<p>In the synchronous upload pipeline:</p>

<ul>
<li>At build time, Unity writes both the header and the binary data for the mesh or texture to the same .res file.</li>
<li>At runtime, when the application needs the texture or mesh, Unity loads both the header data and binary data for that texture or mesh from the .res file into memory. When all of the data is in memory, Unity then uploads the binary data from memory to the GPU. The loading and uploading operations occur mainly on the main thread, in a single frame.</li>
</ul>

<p>In the asynchronous upload pipeline:</p>

<ul>
<li>At build time, Unity writes the header data to a .res file and the binary data to a separate .resS file.</li>
<li>At runtime, hen the application needs the texture or mesh, Unity loads the header from the .res file into memory. When the header is in memory, Unity then streams the binary data from the .resS file to the GPU using a fixed-sized ring buffer. Unity streams the binary data using multiple threads, over the course of several frames. Note that on some console platforms where Unity already knows the GPU hardware, Unity skips the ring buffer and loads straight into the GPU memory.</li>
</ul>

<h2>Texture and mesh data eligibility</h2>

<p>A texture is eligible for the asynchronous upload pipeline if the following conditions are met:</p>

<ul>
<li>The texture is not read/write enabled.</li>
<li>The texture is not in the Resources folder.</li>
<li>If the build target is Android, LZ4 compression is enabled in the Project’s Build Settings.</li>
</ul>

<p>Note that if you load a texture using <code>LoadImage(byte[] data)</code>, this forces Unity to use the synchronous upload pipeline, even if the above conditions are met.</p>

<p>A mesh is eligible for the asynchronous upload pipeline if the following conditions are met:</p>

<ul>
<li>The mesh is not read/write enabled.</li>
<li>The mesh is not in the Resources folder.</li>
<li>The mesh has no <a href="../ScriptReference/Mesh-blendShapeCount.html">BlendShapes</a>.</li>
<li>Unity has not applied Dynamic Batching to the mesh, either because the mesh is ineligible for Dynamic Batching or because Dynamic Batching is disabled. For more information on Dynamic Batching, see <a href="DrawCallBatching.html">Draw call batching</a>.</li>
<li>The mesh vertex/index data is not needed by a Particle System, a Terrain, or a Mesh Collider.</li>
<li>The mesh has no <a href="../ScriptReference/Mesh.boneWeights.html">bone weights</a>.</li>
<li>The mesh <a href="../ScriptReference/MeshTopology.html">topology</a> is not <a href="../ScriptReference/MeshTopology.Quads.html">quads</a>.</li>
<li>The <a href="../ScriptReference/ModelImporter-meshCompression.html">meshCompression</a> for the mesh asset is set to <a href="../ScriptReference/ModelImporterMeshCompression.Off.html">Off</a>.
 If the build target is Android, LZ4 compression is enabled in the Project’s Build Settings.</li>
</ul>

<p>In all other circumstances, Unity loads textures and meshes synchronously.</p>

<h2>How to identify which upload pipeline Unity is using</h2>

<p>You can use the <a href="Profiler.html">Profiler</a> or another profiling tool to identify when Unity is using the asynchronous upload pipeline, by observing thread activity and profiler markers.</p>

<p>The following indicate that Unity is using the asynchronous upload pipeline to upload textures or meshes:</p>

<ul>
<li>The <code>AsyncUploadManager.ScheduleAsyncRead</code>, <code>AsyncReadManager.ReadFile</code>, and <code>Async.DirectTextureLoadBegin</code> profiler markers.</li>
<li>Activity on the <code>AsyncRead</code> thread.</li>
</ul>

<p>If you do not see this activity, then Unity is not using the asynchronous upload pipeline.</p>

<p>Note that the following profiler markers do not indicate that Unity is using the asynchronous upload pipeline; Unity calls them to check whether any asynchronous upload work needs to occur:</p>

<ul>
<li><code>Initialization.AsyncUploadTimeSlicedUpdate</code></li>
<li><code>AsyncUploadManager.AsyncResourceUpload</code></li>
<li><code>AsyncUploadManager.ScheduleAsyncCommands</code></li>
</ul>

<h2>Configuring the asynchronous upload pipeline</h2>

<p>You can configure these settings for the asynchronous upload pipeline. Note that you cannot configure settings for the synchronous upload pipeline.</p>

<figure>
<img src="C:/Mercurial/Manual/2020.1/content/uploads/Main/AsyncUploadQualitySettings.png" alt="The Async Upload settings in the Quality settings">
<figcaption>The Async Upload settings in the Quality settings</figcaption>
</figure>

<h3>Async Upload Buffer</h3>

<p>Unity re-uses a single ring buffer to stream texture and mesh data to the GPU. This reduces the number of memory allocations required.</p>

<p>The <strong>Async Upload Buffer</strong> determines the size of this ring buffer in megabytes. It has a minimum size of 2, and a maximum size of 512.</p>

<p>Unity automatically resizes the buffer to fit the largest texture or mesh that is currently loading. This can be a slow operation, especially if Unity has to perform it more than once; for example, if you are loading many textures that are larger than the default buffer size. To reduce the number of times that Unity must resize the buffer, set this value to fit the largest value that you expect to load. This is usually the largest texture in the Scene. </p>

<p>You can configure this value in the Quality settings window, or using the <a href="../ScriptReference/QualitySettings-asyncUploadBufferSize.html">QualitySettings.asyncUploadBufferSize</a> API.</p>

<h3>Async Upload Time Slice</h3>

<p><strong>Async Upload Time Slice</strong> is the amount of time the CPU spends uploading texture or mesh data to the GPU, in milliseconds per frame.</p>

<p>A larger value means the data will be ready on the GPU sooner, but the CPU will spend more time on upload operations during those frames. Note that Unity only uses this time for uploading if there is data waiting in the buffer to be uploaded to the GPU; if there is no data waiting, Unity can use this time for other operations.</p>

<p>You can configure this value in the Quality settings window, or using the <a href="../ScriptReference/QualitySettings-asyncUploadTimeSlice.html">QualitySettings.asyncUploadTimeSlice</a> API. </p>

<h2>其他信息</h2>

<p>For more information on uploading texture and mesh data asynchronously, see the Unity blog post <a href="https://blogs.unity3d.com/2018/10/08/optimizing-loading-performance-understanding-the-async-upload-pipeline">Optimizing loading performance: Understanding the Async Upload Pipeline</a>.</p>
<!-- area:graphics -->
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="CullingGroupAPI.html"></a></span><div class="tip">CullingGroup API</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="OptimizingGraphicsPerformance.html"></a></span><div class="tip">优化图形性能</div>
</div>
</div>
</div>
<div class="footer-wrapper">
<div class="footer clear">
<div class="copy">版权所有 © 2020 Unity Technologies. Publication 2019.4</div>
<div class="menu">
<a href="https://learn.unity.com/">教程</a><a href="https://answers.unity3d.com">社区答案</a><a href="https://support.unity3d.com/hc/en-us">知识库</a><a href="https://forum.unity3d.com">论坛</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div>
<div></div>
</div>
</div></div></div>
</div>
</body>
</html>
